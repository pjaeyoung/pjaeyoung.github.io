{"componentChunkName":"component---src-templates-blog-post-js","path":"/uiux/infinite-scroll/","result":{"data":{"site":{"siteMetadata":{"title":"DODO's DEV LOG","author":"dodo","siteUrl":"https://pjaeyoung.github.io","comment":{"disqusShortName":"dodo","utterances":"pjaeyoung/dodo-blog"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"e4153396-1154-5abe-9de2-7e172aa97d56","excerpt":"공통으로 사용되는 ScrollList 클래스 items라는 배열이 어디에서(start) 어디까지(end) 렌더링이 되었는지 기억하고 렌더링 가능한 횟수만큼 콜백을 실행시키는 기능을 갖춘 클래스  items 데이터 형태의 제약이 없도록 외부에서  함수를 받도록 구현함    메소드 : items 모두 렌더링되었는지 여부   메소드 : 현재 렌더링된 items 중 마지막 item 반환  메소드 : items 개수가 모두 렌더링될 때까지 일정 개수(perItem)만큼 로드…","html":"<h1 style=\"border-bottom:0;\"> Infinite Scroll 구현 </h1>\n<h3 id=\"공통으로-사용되는-scrolllist-클래스\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%ED%86%B5%EC%9C%BC%EB%A1%9C-%EC%82%AC%EC%9A%A9%EB%90%98%EB%8A%94-scrolllist-%ED%81%B4%EB%9E%98%EC%8A%A4\" aria-label=\"공통으로 사용되는 scrolllist 클래스 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공통으로 사용되는 ScrollList 클래스</h3>\n<ul>\n<li>items라는 배열이 어디에서(start) 어디까지(end) 렌더링이 되었는지 기억하고 렌더링 가능한 횟수만큼 콜백을 실행시키는 기능을 갖춘 클래스 </li>\n<li>\n<p>items 데이터 형태의 제약이 없도록 외부에서 <code class=\"language-text\">createElement</code> 함수를 받도록 구현함 </p>\n<ul>\n<li><code class=\"language-text\">createElement(item:any):Node</code></li>\n</ul>\n</li>\n<li><code class=\"language-text\">isAllItemsRendered</code> 메소드 : items 모두 렌더링되었는지 여부 </li>\n<li><code class=\"language-text\">getLastRenderedItem</code> 메소드 : 현재 렌더링된 items 중 마지막 item 반환</li>\n<li><code class=\"language-text\">render</code> 메소드 : items 개수가 모두 렌더링될 때까지 일정 개수(perItem)만큼 로드</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// ScrollList.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ScrollList</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> $target<span class=\"token punctuation\">,</span> items<span class=\"token punctuation\">,</span> renderPerItem<span class=\"token punctuation\">,</span> createElement <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isInvalidConstructorArgs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        $target<span class=\"token punctuation\">,</span>\n        items<span class=\"token punctuation\">,</span>\n        renderPerItem<span class=\"token punctuation\">,</span>\n        createElement<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>ScrollList<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">.</span>invalidConstructorArgs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$target <span class=\"token operator\">=</span> $target<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>items <span class=\"token operator\">=</span> items<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderPerItem <span class=\"token operator\">=</span> renderPerItem<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>createElement <span class=\"token operator\">=</span> createElement<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currentLastIndex <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">isInvalidConstructorArgs</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> $target<span class=\"token punctuation\">,</span> items<span class=\"token punctuation\">,</span> renderPerItem<span class=\"token punctuation\">,</span> createElement <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>$target <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">HTMLElement</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span>\n      <span class=\"token operator\">!</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span>\n      <span class=\"token keyword\">typeof</span> renderPerItem <span class=\"token operator\">!==</span> <span class=\"token string\">\"number\"</span> <span class=\"token operator\">||</span>\n      <span class=\"token keyword\">typeof</span> createElement <span class=\"token operator\">!==</span> <span class=\"token string\">\"function\"</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">isAllItemsRendered</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currentLastIndex <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token operator\">===</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">getLastRenderedItem</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$target<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">[</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currentLastIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isAllItemsRendered</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> startIndex <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currentLastIndex <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> endIndex <span class=\"token operator\">=</span> startIndex <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderPerItem<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span>startIndex<span class=\"token punctuation\">,</span> endIndex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">anItem</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$target<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>anItem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currentLastIndex<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nScrollList<span class=\"token punctuation\">.</span>messages <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  invalidConstructorArgs<span class=\"token operator\">:</span> <span class=\"token string\">\"잘못된 인자로 ScrollList 인스턴스를 생성했습니다.\"</span><span class=\"token punctuation\">,</span>\n  notNumberArg<span class=\"token operator\">:</span> <span class=\"token string\">\"인자 타입이 숫자가 아닙니다.\"</span><span class=\"token punctuation\">,</span>\n  lastIndexOverItemsCount<span class=\"token operator\">:</span> <span class=\"token string\">\"lastIndex 값이 items 개수보다 큽니다.\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"1-스크롤-위치-계산하여-구현하는-방법\" style=\"position:relative;\"><a href=\"#1-%EC%8A%A4%ED%81%AC%EB%A1%A4-%EC%9C%84%EC%B9%98-%EA%B3%84%EC%82%B0%ED%95%98%EC%97%AC-%EA%B5%AC%ED%98%84%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\" aria-label=\"1 스크롤 위치 계산하여 구현하는 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 스크롤 위치 계산하여 구현하는 방법</h3>\n<h4 id=\"-사전-지식\" style=\"position:relative;\"><a href=\"#-%EC%82%AC%EC%A0%84-%EC%A7%80%EC%8B%9D\" aria-label=\" 사전 지식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📖 사전 지식</h4>\n<ul>\n<li><code class=\"language-text\">document.documentElement</code>는 <code class=\"language-text\">html</code>을 가리킴 </li>\n<li><code class=\"language-text\">html.scrollHeight</code>은 스크롤에 감춰진 영역을 포함한 전체 높이 값을 의미함</li>\n<li><code class=\"language-text\">window.innerHeight</code>은 브라우저의 탭/주소입력/북마크 바를 제외한 보여지는 영역을 의미함.</li>\n<li><code class=\"language-text\">window.scrollY</code>는 스크롤 가능한 영역 사이에 위치한 값 </li>\n<li>스크롤 가능한 영역은 별다른 엘리먼트 태그가 없다면 스크롤에 감춰진 영역, 즉 <code class=\"language-text\">html.scrollHeight - window.innerHeight</code> 값</li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/47022167/110747297-847b5780-8281-11eb-9302-c8a361d06b5f.png\" alt=\"스크린샷, 2021-03-11 15-50-06\"></p>\n<h4 id=\"동작원리\" style=\"position:relative;\"><a href=\"#%EB%8F%99%EC%9E%91%EC%9B%90%EB%A6%AC\" aria-label=\"동작원리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>동작원리</h4>\n<ul>\n<li>scroll handle의 bottom의 위치가 감춰진 영역의 bottom 위치까지 도달하면 감춰진 영역은 0가 된다.\n<img src=\"https://user-images.githubusercontent.com/47022167/110748237-cb1d8180-8282-11eb-8718-bcf1e7fac043.png\" alt=\"스크린샷, 2021-03-11 15-58-32\"></li>\n<li>이 때 새로운 엘리먼트들을 추가하여 감춰진 영역 크기를 만들어 계속 스크롤할 수 있게 된다. <br/>\n<img src=\"https://user-images.githubusercontent.com/47022167/110748278-d8d30700-8282-11eb-9c4e-0c1af07c0684.png\" alt=\"스크린샷, 2021-03-11 15-59-21\"></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// index.js</span>\n\n<span class=\"token keyword\">import</span> ScrollList <span class=\"token keyword\">from</span> <span class=\"token string\">\"./components/ScrollList.js\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> $li <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"li\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  $li<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> <span class=\"token string\">\"scroll-item\"</span><span class=\"token punctuation\">;</span>\n  $li<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> item<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> $li<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">createLoadMore</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> scrollList<span class=\"token punctuation\">,</span> html <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token function\">loadMore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> scrollableHeight <span class=\"token operator\">=</span> html<span class=\"token punctuation\">.</span>scrollHeight <span class=\"token operator\">-</span> window<span class=\"token punctuation\">.</span>innerHeight<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>scrollY <span class=\"token operator\">>=</span> scrollableHeight<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      scrollList<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> items <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">(</span><span class=\"token number\">21</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">item </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">PER_ITEMS</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> scrollList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ScrollList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    $target<span class=\"token operator\">:</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#scroll-list\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    items<span class=\"token punctuation\">,</span>\n    renderPerItem<span class=\"token operator\">:</span> <span class=\"token constant\">PER_ITEMS</span><span class=\"token punctuation\">,</span>\n    createElement<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"scroll\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">createLoadMore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> scrollList<span class=\"token punctuation\">,</span> html<span class=\"token operator\">:</span> document<span class=\"token punctuation\">.</span>documentElement <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"2-intersectionobserver-사용하여-구현하는-방법\" style=\"position:relative;\"><a href=\"#2-intersectionobserver-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EA%B5%AC%ED%98%84%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\" aria-label=\"2 intersectionobserver 사용하여 구현하는 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. IntersectionObserver 사용하여 구현하는 방법</h3>\n<h4 id=\"-사전지식\" style=\"position:relative;\"><a href=\"#-%EC%82%AC%EC%A0%84%EC%A7%80%EC%8B%9D\" aria-label=\" 사전지식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📖 사전지식</h4>\n<ul>\n<li><code class=\"language-text\">IntersectionObserver</code>는 타겟을 지정하고난 후 타겟이 ‘보여지는 영역’에 나타났는지 관찰, 감시하는 기능이 있다. </li>\n<li>\n<p>생성자에 감지할 때 호출하는 콜백함수와 감지 영역 및 감지 비율을 지정하는 옵션값을 넘긴다. </p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">new</span> <span class=\"token class-name\">IntersectionObserver</span><span class=\"token punctuation\">(</span>callback<span class=\"token punctuation\">,</span>options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n<li><code class=\"language-text\">callback</code> : 감지할 대상으로 등록한 타겟 목록들(entries)과 observer 인스턴스 자신을 인자로 받는 형태다. 콜백이 곧바로 실행되므로 등록한 타겟이 감지되었는지 확인 후 감지되었을 때 원하는 동작을 실행해야한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">entries<span class=\"token punctuation\">,</span>observer</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 감지된 경우 </span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>entries<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>isIntersecting<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 원하는 동작 실행</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">options</code>는 타겟을 감지할 영역(root)과 영역크기(rootMargin) 그리고 타겟이 영역에 노출된 비율(threshold)를 결정하는 객체다. 각각 문서의 뷰포트, “0px”, 0 값이 디폴트다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> options <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    root<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n    rootMargin<span class=\"token operator\">:</span><span class=\"token string\">\"0px\"</span><span class=\"token punctuation\">,</span>\n    threshold<span class=\"token operator\">:</span><span class=\"token number\">0</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"동작원리-1\" style=\"position:relative;\"><a href=\"#%EB%8F%99%EC%9E%91%EC%9B%90%EB%A6%AC-1\" aria-label=\"동작원리 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>동작원리</h4>\n<ul>\n<li>전체 목록 중 일부만 먼저 렌더링한다.</li>\n<li>마지막에 렌더링한 값만 감시한다.\n<img src=\"https://user-images.githubusercontent.com/47022167/110752450-a62c0d00-8288-11eb-96be-e04536d78bcd.png\" alt=\"스크린샷, 2021-03-11 16-36-46\"></li>\n<li>마지막에 렌더링한 엘리먼트가 감지되면 전체 목록에서 아직 렌더링되지 않은 값들을 추가적으로 렌더링한다.\n<img src=\"https://user-images.githubusercontent.com/47022167/110752490-b217cf00-8288-11eb-9f1e-5b2b7c8afa56.png\" alt=\"스크린샷, 2021-03-11 16-39-21\">\n<img src=\"https://user-images.githubusercontent.com/47022167/110752517-b93edd00-8288-11eb-8ca1-ce0b038793f2.png\" alt=\"스크린샷, 2021-03-11 16-41-10\"></li>\n<li>전체 목록이 모두 렌더링하기 전까지 위 과정을 반복한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// index.js</span>\n\n<span class=\"token keyword\">import</span> ScrollList <span class=\"token keyword\">from</span> <span class=\"token string\">\"./components/ScrollList.js\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> items <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">(</span><span class=\"token number\">21</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">item </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PER_ITEMS</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> $li <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"li\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  $li<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> <span class=\"token string\">\"scroll-item\"</span><span class=\"token punctuation\">;</span>\n  $li<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> item<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> $li<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">createObserverCallback</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">scrollList</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">entries<span class=\"token punctuation\">,</span> observer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>entries<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>isIntersecting<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    observer<span class=\"token punctuation\">.</span><span class=\"token function\">unobserve</span><span class=\"token punctuation\">(</span>entries<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>scrollList<span class=\"token punctuation\">.</span><span class=\"token function\">isAllItemsRendered</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      observer<span class=\"token punctuation\">.</span><span class=\"token function\">disconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      scrollList<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      observer<span class=\"token punctuation\">.</span><span class=\"token function\">observe</span><span class=\"token punctuation\">(</span>scrollList<span class=\"token punctuation\">.</span><span class=\"token function\">getLastRenderedItem</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> scrollList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ScrollList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    $target<span class=\"token operator\">:</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#scroll-list\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    items<span class=\"token punctuation\">,</span>\n    renderPerItem<span class=\"token operator\">:</span> <span class=\"token constant\">PER_ITEMS</span><span class=\"token punctuation\">,</span>\n    createElement<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> io <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IntersectionObserver</span><span class=\"token punctuation\">(</span><span class=\"token function\">createObserverCallback</span><span class=\"token punctuation\">(</span>scrollList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    threshold<span class=\"token operator\">:</span> <span class=\"token number\">0.8</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  io<span class=\"token punctuation\">.</span><span class=\"token function\">observe</span><span class=\"token punctuation\">(</span>scrollList<span class=\"token punctuation\">.</span><span class=\"token function\">getLastRenderedItem</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"title":"infinite scroll","date":"March 11, 2021"}}},"pageContext":{"slug":"/uiux/infinite-scroll/","previous":{"fields":{"slug":"/uiux/scroll-animation/"},"frontmatter":{"title":"scroll animation","category":"uiux","draft":false}},"next":{"fields":{"slug":"/challenge30/21/"},"frontmatter":{"title":"21","category":"challenge30","draft":false}}}},"staticQueryHashes":["3128451518","521680639"]}
{"componentChunkName":"component---src-templates-blog-post-js","path":"/uiux/Particle/","result":{"data":{"site":{"siteMetadata":{"title":"DODO's DEV LOG","author":"dodo","siteUrl":"https://pjaeyoung.github.io","comment":{"disqusShortName":"dodo","utterances":"pjaeyoung/dodo-blog"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"49db429e-cdbb-5a23-9b2e-593f11f37fd0","excerpt":"지난 글 HTML5 Canvas 기초다지기를 응용한 Canvas와 인터랙션을 다룬 유튜브 영상을 따라 만들었습니다. 먼저 html 파일에  태그를 하나 생성합니다. canvas크기는 css로 조정했습니다. 아래에 다시 설명하겠지만 이 방식은 권장하지 않습니다. 그 다음 javascript 파일에서 300개의 particle을 그려줍니다. particle이 canvas에서 원형으로 그려지고 canvas 크기 안에서 x,y…","html":"<figure style=\"text-align:center\">\n    <img style=\"border: 5px solid rgb(234, 234, 234)\" src=\"https://user-images.githubusercontent.com/47022167/114046868-29f70a80-98c4-11eb-8d9a-8e6fb4b669c9.gif\" alt=\"마우스와 캔버스 도형의 상호작용\">\n</figure>\n<p>지난 글 <a href=\"https://pjaeyoung.github.io/uiux/html5-canvas-%EA%B8%B0%EC%B4%88%EB%8B%A4%EC%A7%80%EA%B8%B0--/\">HTML5 Canvas 기초다지기</a>를 응용한 Canvas와 인터랙션을 다룬 <a href=\"https://youtu.be/vxljFhP2krI\">유튜브 영상</a>을 따라 만들었습니다.</p>\n<p>먼저 html 파일에 <code class=\"language-text\">canvas</code> 태그를 하나 생성합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>canvas</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>canvas1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>canvas</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>index.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>canvas크기는 css로 조정했습니다. 아래에 다시 설명하겠지만 이 방식은 권장하지 않습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">#canvas1</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 500px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 300px<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>그 다음 javascript 파일에서 300개의 particle을 그려줍니다.</p>\n<p>particle이 canvas에서 원형으로 그려지고 canvas 크기 안에서 x,y 방향으로 움직일 수 있다는 공통 특성이 존재하기 때문에 클래스로 구현했습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Particle</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>\n    x<span class=\"token punctuation\">,</span>\n    y<span class=\"token punctuation\">,</span>\n    dx<span class=\"token punctuation\">,</span>\n    dy<span class=\"token punctuation\">,</span>\n    radius<span class=\"token punctuation\">,</span>\n    fillStyle<span class=\"token punctuation\">,</span>\n    ctx<span class=\"token punctuation\">,</span>\n    canvasHeight<span class=\"token punctuation\">,</span>\n    canvasWidth<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">=</span> x <span class=\"token comment\">// 원의 중심 x축 위치</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">=</span> y <span class=\"token comment\">// 원의 중심 y축 위치</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">=</span> radius <span class=\"token comment\">// 반지름</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dx <span class=\"token operator\">=</span> dx <span class=\"token comment\">// x축으로 이동할 거리</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dy <span class=\"token operator\">=</span> dy <span class=\"token comment\">// y축으로 이동할 거리</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx <span class=\"token operator\">=</span> ctx <span class=\"token comment\">// CanvasRenderingContext2D 객체</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_fillStyle <span class=\"token operator\">=</span> fillStyle <span class=\"token comment\">// 원의 색상</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight <span class=\"token operator\">=</span> canvasHeight <span class=\"token comment\">// 캔버스 높이</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth <span class=\"token operator\">=</span> canvasWidth <span class=\"token comment\">// 캔버스 너비</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>animate <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">animate</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>animate<span class=\"token punctuation\">)</span> <span class=\"token comment\">// particle 인스턴스 생성하자마자 애니메이션 활성화</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// canvas 안에서 x축 이동하도록 좌우방향 지정</span>\n  <span class=\"token keyword\">get</span> <span class=\"token function\">dx</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth <span class=\"token operator\">||</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dx <span class=\"token operator\">*=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dx\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// canvas 안에서 y축 이동하도록 상하방향 지정</span>\n  <span class=\"token keyword\">get</span> <span class=\"token function\">dy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight <span class=\"token operator\">||</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dy <span class=\"token operator\">*=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dy\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// 원의 중심을 원의 이동거리만큼 더한 값으로 갱신</span>\n  <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">+=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dx\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">+=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dy\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// 갱신된 원의 중심에서 원 그리기</span>\n  <span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span><span class=\"token function\">beginPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_fillStyle\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span><span class=\"token function\">arc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token constant\">PI</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// requestAnimationFrame에 호출할 콜백함수</span>\n  <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span><span class=\"token function\">clearRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>animate<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">dx</code>와 <code class=\"language-text\">dy</code> 접근자 프로퍼티는 particle이 canvas를 벗어났는지 측정하여 canvas 내에 움직이도록 방향을 바꿔줍니다. 반지름을 더하거나 빼는 계산과정이 있는 이유는 particle의 면적을 기준으로 canvas를 벗어났는지 확인하기 위해서입니다. 가령, 반지름 없이 <code class=\"language-text\">this._x &gt; this._canvasWidth</code> 로 계산하게 된다면 아래와 같이 canvas 밖으로 절반의 면적이 뚫고 나옵니다.</p>\n<figure style=\"display:flex; flex-direction:column;align-items:center;\">\n<figcaption style=\"color:grey;\">반지름 고려하지 않은 경우</figcaption>\n<img style=\"border: 1px solid grey; width: 80%;\" src=\"https://user-images.githubusercontent.com/47022167/114135780-b6e1a880-9944-11eb-8977-345d52b4dfb7.png\" alt=\"반지름 고려하지 않은 경우\">\n</figure>\n<p>반지름을 고려해 계산하면 정확히 particle의 면적이 canvas 밖으로 나오지 않고 방향을 바꿔 이동하게 됩니다.</p>\n<figure style=\"display:flex; flex-direction:column;align-items:center;\">\n<figcaption style=\"color:grey;\">반지름 고려한 경우</figcaption>\n<img style=\"border: 1px solid grey; width:80%\" src=\"https://user-images.githubusercontent.com/47022167/114135786-b77a3f00-9944-11eb-8ffd-00f85daeb9d9.png\" alt=\"반지름 고려한 경우\">\n</figure>\n<p>이제 300개의 Particle 인스턴스를 생성해봅니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">createAParticle</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> ctx<span class=\"token punctuation\">,</span> canvasHeight<span class=\"token punctuation\">,</span> canvasWidth<span class=\"token punctuation\">,</span> colors <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> radius <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> diameter <span class=\"token operator\">=</span> radius <span class=\"token operator\">*</span> <span class=\"token number\">2</span>\n  <span class=\"token keyword\">const</span> x <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>canvasWidth <span class=\"token operator\">-</span> diameter<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> diameter\n  <span class=\"token keyword\">const</span> y <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>canvasHeight <span class=\"token operator\">-</span> diameter<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> diameter\n  <span class=\"token keyword\">const</span> dx <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">1</span> <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span>\n  <span class=\"token keyword\">const</span> dy <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">1</span> <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span>\n  <span class=\"token keyword\">const</span> color <span class=\"token operator\">=</span> colors<span class=\"token punctuation\">[</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> colors<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Particle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    x<span class=\"token punctuation\">,</span>\n    y<span class=\"token punctuation\">,</span>\n    dx<span class=\"token punctuation\">,</span>\n    dy<span class=\"token punctuation\">,</span>\n    radius<span class=\"token punctuation\">,</span>\n    fillStyle<span class=\"token operator\">:</span> color<span class=\"token punctuation\">,</span>\n    ctx<span class=\"token punctuation\">,</span>\n    canvasHeight<span class=\"token punctuation\">,</span>\n    canvasWidth<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> $canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#canvas1'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> $canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> colors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'#9EBCCE'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#E84925'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#CBD8E0'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#262E31'</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token keyword\">let</span> count <span class=\"token operator\">=</span> <span class=\"token number\">300</span>\n\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>count<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">createAParticle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      ctx<span class=\"token punctuation\">,</span>\n      colors<span class=\"token punctuation\">,</span>\n      canvasHeight<span class=\"token operator\">:</span> $canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">,</span>\n      canvasWidth<span class=\"token operator\">:</span> $canvas<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>빈 화면이 나옵니다.😅</p>\n<p>Particle 클래스 내부에 clearRect를 한 게 원인이었습니다. 제가 작성한 코드는 particle 하나를 그리면 다음에 그려질 particle에서 이전에 그려진 particle을 지우는 작업을 했던 겁니다. 하나하나 하드코딩으로 작성하다 클래스로 한 번에 그리도록 하려다가 canvas 원리에 대해 혼선이 왔습니다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/47022167/114141870-28bdf000-994d-11eb-8d59-1d5b77fa0f6e.png\" alt=\"스크린샷, 2021-04-09 15-53-12\">\n<img src=\"https://user-images.githubusercontent.com/47022167/114141875-29ef1d00-994d-11eb-890a-2eb4d4049cee.png\" alt=\"스크린샷, 2021-04-09 15-55-31\">\n<img src=\"https://user-images.githubusercontent.com/47022167/114141877-29ef1d00-994d-11eb-927a-c64afa39427a.png\" alt=\"스크린샷, 2021-04-09 16-03-35\"></p>\n<p>각각의 Particle에서 지우는 과정을 넣지 않고 모든 Particle이 그린 후 한 번에 지우도록 해줍니다.</p>\n<p>Particle 클래스에서 canvas를 지우는 코드와 애니메이션을 실행시키는 코드를 삭제합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Particle</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>\n    x<span class=\"token punctuation\">,</span>\n    y<span class=\"token punctuation\">,</span>\n    dx<span class=\"token punctuation\">,</span>\n    dy<span class=\"token punctuation\">,</span>\n    radius<span class=\"token punctuation\">,</span>\n    fillStyle<span class=\"token punctuation\">,</span>\n    ctx<span class=\"token punctuation\">,</span>\n    canvasHeight<span class=\"token punctuation\">,</span>\n    canvasWidth<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">=</span> x <span class=\"token comment\">// 원의 중심 x축 위치</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">=</span> y <span class=\"token comment\">// 원의 중심 y축 위치</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">=</span> radius <span class=\"token comment\">// 반지름</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dx <span class=\"token operator\">=</span> dx <span class=\"token comment\">// x축으로 이동할 거리</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dy <span class=\"token operator\">=</span> dy <span class=\"token comment\">// y축으로 이동할 거리</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx <span class=\"token operator\">=</span> ctx <span class=\"token comment\">// CanvasRenderingContext2D 객체</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_fillStyle <span class=\"token operator\">=</span> fillStyle <span class=\"token comment\">// 원의 색상</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight <span class=\"token operator\">=</span> canvasHeight <span class=\"token comment\">// 캔버스 높이</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth <span class=\"token operator\">=</span> canvasWidth <span class=\"token comment\">// 캔버스 너비</span>\n\n    <span class=\"token comment\">// this.animate = this.animate.bind(this)</span>\n    <span class=\"token comment\">// requestAnimationFrame(this.animate)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">get</span> <span class=\"token function\">dx</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth <span class=\"token operator\">||</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dx <span class=\"token operator\">*=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dx\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">get</span> <span class=\"token function\">dy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight <span class=\"token operator\">||</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dy <span class=\"token operator\">*=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dy\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">+=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dx\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">+=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dy\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span><span class=\"token function\">beginPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_fillStyle\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span><span class=\"token function\">arc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token constant\">PI</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// this._ctx.clearRect(0, 0, this._canvasWidth, this._canvasHeight)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// requestAnimationFrame(this.animate)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>init 함수도 아래처럼 변경해줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> $canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#canvas1'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> $canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> colors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'#9EBCCE'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#E84925'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#CBD8E0'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#262E31'</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token keyword\">let</span> count <span class=\"token operator\">=</span> <span class=\"token number\">300</span>\n  <span class=\"token keyword\">const</span> particles <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>count<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    particles<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>\n      <span class=\"token function\">createAParticle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        ctx<span class=\"token punctuation\">,</span>\n        colors<span class=\"token punctuation\">,</span>\n        canvasHeight<span class=\"token operator\">:</span> $canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">,</span>\n        canvasWidth<span class=\"token operator\">:</span> $canvas<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">animateParticles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 300개의 particle들이 그려진 캔버스를 한 번에 지워주기</span>\n    ctx<span class=\"token punctuation\">.</span><span class=\"token function\">clearRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> $canvas<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> $canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span>\n    particles<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span> <span class=\"token operator\">=></span> p<span class=\"token punctuation\">.</span><span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>animateParticles<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>animateParticles<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>그러면 particles가 제각기 다른 위치에서 다른 속도로 잘 움직입니다.\n<img src=\"https://user-images.githubusercontent.com/47022167/114144059-df22d480-994f-11eb-974d-abc127cbc193.png\" alt=\"스크린샷, 2021-04-09 16-22-57\"></p>\n<p>그런데 픽셀이 심하게 깨집니다. 컴퓨터 화질 문제인가? 해서 넘어갔습니다(그 문제가 아니야!).</p>\n<p>이제 마우스 커서가 있는 위치에서 일정 반경으로 particle이 커지는 효과를 만듭니다.</p>\n<p>그전에 particle들을 생성하고 마우스 커서와 충돌했는지 제어하는 코드를 한 곳에 모으기 위해 ParticleController 클래스를 생성합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ParticleController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> ctx<span class=\"token punctuation\">,</span> $canvas<span class=\"token punctuation\">,</span> colors<span class=\"token punctuation\">,</span> count <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx <span class=\"token operator\">=</span> ctx\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight <span class=\"token operator\">=</span> $canvas<span class=\"token punctuation\">.</span>height\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth <span class=\"token operator\">=</span> $canvas<span class=\"token punctuation\">.</span>width\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_colors <span class=\"token operator\">=</span> colors\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_count <span class=\"token operator\">=</span> count\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_createAParticle <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_createAParticle</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_particles <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_createParticles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_animate <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_animate</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// 인스턴스를 생성하자마자 애니메이션을 실행시킵니다</span>\n    <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_animate<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">_createAParticle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> radius <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> diameter <span class=\"token operator\">=</span> radius <span class=\"token operator\">*</span> <span class=\"token number\">2</span>\n    <span class=\"token keyword\">const</span> x <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth <span class=\"token operator\">-</span> diameter<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> diameter\n    <span class=\"token keyword\">const</span> y <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight <span class=\"token operator\">-</span> diameter<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> diameter\n    <span class=\"token keyword\">const</span> dx <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">1</span> <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span>\n    <span class=\"token keyword\">const</span> dy <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">1</span> <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span>\n    <span class=\"token keyword\">const</span> color <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_colors<span class=\"token punctuation\">[</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_colors<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Particle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      x<span class=\"token punctuation\">,</span>\n      y<span class=\"token punctuation\">,</span>\n      dx<span class=\"token punctuation\">,</span>\n      dy<span class=\"token punctuation\">,</span>\n      radius<span class=\"token punctuation\">,</span>\n      fillStyle<span class=\"token operator\">:</span> color<span class=\"token punctuation\">,</span>\n      ctx<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">,</span>\n      canvasHeight<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight<span class=\"token punctuation\">,</span>\n      canvasWidth<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">_createParticles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// while문 대신 배열 메서드 파이프라인으로 리팩토링합니다</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_createAParticle<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">_clearCanvas</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span><span class=\"token function\">clearRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">_animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_clearCanvas</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_particles<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span> <span class=\"token operator\">=></span> p<span class=\"token punctuation\">.</span><span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_animate<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">checkCollisions</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mouse</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 마우스 커서 위치 충돌 체크할 코드 작성</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>init 함수에서 window객체에 <code class=\"language-text\">mousemove</code> 이벤트 리스너로 마우스 위치값을 받아 ParticleController의 <code class=\"language-text\">checkCollisions</code> 메서드 인자로 넘겨줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> $canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#canvas1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> $canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2d\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> colors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"#9EBCCE\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#E84925\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#CBD8E0\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#262E31\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> particleController <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ParticleController</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    ctx<span class=\"token punctuation\">,</span>\n    $canvas<span class=\"token punctuation\">,</span>\n    colors<span class=\"token punctuation\">,</span>\n    count<span class=\"token operator\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mousemove\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    particleController<span class=\"token punctuation\">.</span><span class=\"token function\">checkCollisions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      x<span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span>\n      y<span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">mousemove</code> 콜백 함수가 호출 될 때 마다 모든 particle들이 mouse 커서의 일정 반경에 들어왔는지 확인해줘야 합니다. 각 particle이 자신이 mouse 커서의 일정 반경에 들어왔는지 확인하도록 하고 ParticleController에서 particle들을 차례대로 순회하면서 이 과정을 진행하도록 합니다.</p>\n<p>Particle 클래스에 충돌여부를 저장할 collided 속성과 <code class=\"language-text\">checkCollision</code>메서드를 추가합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Particle</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* 이전 코드 생략 */</span>\n\n  <span class=\"token keyword\">get</span> <span class=\"token function\">radius</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">set</span> <span class=\"token function\">radius</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 반지름이 무한대로 커지거나 작아지지 않도록 예외처리합니다.</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>number <span class=\"token operator\">></span> <span class=\"token number\">20</span> <span class=\"token operator\">||</span> number <span class=\"token operator\">&lt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_initRadius<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">=</span> number\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">+=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dx\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">+=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dy\n\n    <span class=\"token comment\">// 충돌되면 반지름 크기를 늘리고 아니면 반지름 크기를 줄입니다.</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_collided<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius <span class=\"token operator\">-=</span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// 자신의 중심이 마우스 커서 반경(25) 사이에 존재하는 지 확인합니다.</span>\n  <span class=\"token function\">checkCollision</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mouse</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_collided <span class=\"token operator\">=</span>\n      mouse<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">&lt;</span> <span class=\"token number\">25</span> <span class=\"token operator\">&amp;&amp;</span>\n      mouse<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">></span> <span class=\"token operator\">-</span><span class=\"token number\">25</span> <span class=\"token operator\">&amp;&amp;</span>\n      mouse<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">&lt;</span> <span class=\"token number\">25</span> <span class=\"token operator\">&amp;&amp;</span>\n      mouse<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">></span> <span class=\"token operator\">-</span><span class=\"token number\">25</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ParticleController에서 <code class=\"language-text\">checkCollisions</code> 메서드를 구현합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ParticleController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* 이전 코드 생략*/</span>\n\n  <span class=\"token function\">checkCollisions</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mouse</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_particles<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      p<span class=\"token punctuation\">.</span><span class=\"token function\">checkCollision</span><span class=\"token punctuation\">(</span>mouse<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>되긴 되는데 마우스 커서 위치와 너무 떨어져있습니다.🤪</p>\n<p><img src=\"https://user-images.githubusercontent.com/47022167/114147721-f4016700-9953-11eb-9f54-36b075a4388a.png\" alt=\"스크린샷, 2021-04-09 16-52-07\"></p>\n<p>알고보니 canvas 속성을 지정하지 않았을 때 디폴트 값이 적용된 상태에서 css로 크기를 늘렸던 거였습니다. <a href=\"https://developer.mozilla.org/ko/docs/Web/API/Canvas_API/Tutorial/Basic_usage\">MDN</a> 에서도 css 크기 지정이 초기 비율을 고려하지 않을 때 왜곡된다고 합니다. 🧐</p>\n<p>canvas 속성으로 width, height 을 명시적으로 지정하니 픽셀 깨지는 현상과 마우스 위치 어긋나는 현상이 사라졌습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>canvas</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>canvas1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>500<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>300<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>canvas</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>index.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>혹은 javascript 상에서 canvas 크기를 직접 지정할 수도 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> $canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#canvas1'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> $canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// canvas 크기를 window 사이즈 크기에 맞게 만들어 주고 싶을 때 javascript를 사용합니다.</span>\n  <span class=\"token comment\">// 태그 속성으로는 %, vw,vh와 같은 단위를 사용할 수 없기 때문입니다.</span>\n  $canvas<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">,</span> window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token punctuation\">)</span>\n  $canvas<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">,</span> window<span class=\"token punctuation\">.</span>innerHeight<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> colors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'#9EBCCE'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#E84925'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#CBD8E0'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#262E31'</span><span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">let</span> particleController <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ParticleController</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    ctx<span class=\"token punctuation\">,</span>\n    $canvas<span class=\"token punctuation\">,</span>\n    colors<span class=\"token punctuation\">,</span>\n    count<span class=\"token operator\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mousemove'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    particleController<span class=\"token punctuation\">.</span><span class=\"token function\">checkCollisions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      x<span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span>\n      y<span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>전체 코드는 아래와 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Particle</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>\n    x<span class=\"token punctuation\">,</span>\n    y<span class=\"token punctuation\">,</span>\n    dx<span class=\"token punctuation\">,</span>\n    dy<span class=\"token punctuation\">,</span>\n    radius<span class=\"token punctuation\">,</span>\n    fillStyle<span class=\"token punctuation\">,</span>\n    ctx<span class=\"token punctuation\">,</span>\n    canvasHeight<span class=\"token punctuation\">,</span>\n    canvasWidth<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">=</span> x\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">=</span> y\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_initRadius <span class=\"token operator\">=</span> radius\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">=</span> radius\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dx <span class=\"token operator\">=</span> dx\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dy <span class=\"token operator\">=</span> dy\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx <span class=\"token operator\">=</span> ctx\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_fillStyle <span class=\"token operator\">=</span> fillStyle\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight <span class=\"token operator\">=</span> canvasHeight\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth <span class=\"token operator\">=</span> canvasWidth\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_collided <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">get</span> <span class=\"token function\">radius</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">set</span> <span class=\"token function\">radius</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>number <span class=\"token operator\">></span> <span class=\"token number\">20</span> <span class=\"token operator\">||</span> number <span class=\"token operator\">&lt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_initRadius<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">=</span> number\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">get</span> <span class=\"token function\">dx</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth <span class=\"token operator\">||</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dx <span class=\"token operator\">*=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dx\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">get</span> <span class=\"token function\">dy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight <span class=\"token operator\">||</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_radius <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dy <span class=\"token operator\">*=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_dy\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">+=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dx\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">+=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dy\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_collided<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius <span class=\"token operator\">-=</span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span><span class=\"token function\">beginPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_fillStyle\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span><span class=\"token function\">arc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token constant\">PI</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">checkCollision</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mouse</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_collided <span class=\"token operator\">=</span>\n      mouse<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">&lt;</span> <span class=\"token number\">25</span> <span class=\"token operator\">&amp;&amp;</span>\n      mouse<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_x <span class=\"token operator\">></span> <span class=\"token operator\">-</span><span class=\"token number\">25</span> <span class=\"token operator\">&amp;&amp;</span>\n      mouse<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">&lt;</span> <span class=\"token number\">25</span> <span class=\"token operator\">&amp;&amp;</span>\n      mouse<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_y <span class=\"token operator\">></span> <span class=\"token operator\">-</span><span class=\"token number\">25</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ParticleController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> ctx<span class=\"token punctuation\">,</span> $canvas<span class=\"token punctuation\">,</span> colors<span class=\"token punctuation\">,</span> count <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx <span class=\"token operator\">=</span> ctx\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight <span class=\"token operator\">=</span> $canvas<span class=\"token punctuation\">.</span>height\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth <span class=\"token operator\">=</span> $canvas<span class=\"token punctuation\">.</span>width\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_colors <span class=\"token operator\">=</span> colors\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_count <span class=\"token operator\">=</span> count\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_createAParticle <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_createAParticle</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_particles <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_createParticles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_animate <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_animate</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_animate<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">_createAParticle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> radius <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> diameter <span class=\"token operator\">=</span> radius <span class=\"token operator\">*</span> <span class=\"token number\">2</span>\n    <span class=\"token keyword\">const</span> x <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth <span class=\"token operator\">-</span> diameter<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> diameter\n    <span class=\"token keyword\">const</span> y <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight <span class=\"token operator\">-</span> diameter<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> diameter\n    <span class=\"token keyword\">const</span> dx <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">1</span> <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span>\n    <span class=\"token keyword\">const</span> dy <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">1</span> <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span>\n    <span class=\"token keyword\">const</span> color <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_colors<span class=\"token punctuation\">[</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_colors<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Particle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      x<span class=\"token punctuation\">,</span>\n      y<span class=\"token punctuation\">,</span>\n      dx<span class=\"token punctuation\">,</span>\n      dy<span class=\"token punctuation\">,</span>\n      radius<span class=\"token punctuation\">,</span>\n      fillStyle<span class=\"token operator\">:</span> color<span class=\"token punctuation\">,</span>\n      ctx<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">,</span>\n      canvasHeight<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight<span class=\"token punctuation\">,</span>\n      canvasWidth<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">_createParticles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_createAParticle<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">_clearCanvas</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_ctx<span class=\"token punctuation\">.</span><span class=\"token function\">clearRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasWidth<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_canvasHeight<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">_animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_clearCanvas</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_particles<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span> <span class=\"token operator\">=></span> p<span class=\"token punctuation\">.</span><span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_animate<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">checkCollisions</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mouse</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_particles<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      p<span class=\"token punctuation\">.</span><span class=\"token function\">checkCollision</span><span class=\"token punctuation\">(</span>mouse<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> $canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#canvas1'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> $canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span>\n  $canvas<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">,</span> window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token punctuation\">)</span>\n  $canvas<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">,</span> window<span class=\"token punctuation\">.</span>innerHeight<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> colors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'#9EBCCE'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#E84925'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#CBD8E0'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#262E31'</span><span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">let</span> particleController <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ParticleController</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    ctx<span class=\"token punctuation\">,</span>\n    $canvas<span class=\"token punctuation\">,</span>\n    colors<span class=\"token punctuation\">,</span>\n    count<span class=\"token operator\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mousemove'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    particleController<span class=\"token punctuation\">.</span><span class=\"token function\">checkCollisions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      x<span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span>\n      y<span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"참고-사이트\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0-%EC%82%AC%EC%9D%B4%ED%8A%B8\" aria-label=\"참고 사이트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고 사이트</h3>\n<p><a href=\"https://youtu.be/vxljFhP2krI\">Interacting with The Canvas | HTML5 Canvas Tutorial for Beginners - Ep. 4</a></p>","frontmatter":{"title":"Particle","date":"April 08, 2021"}}},"pageContext":{"slug":"/uiux/Particle/","previous":{"fields":{"slug":"/challenge30/23/"},"frontmatter":{"title":"23","category":"challenge30","draft":false}},"next":null}},"staticQueryHashes":["3128451518","521680639"]}
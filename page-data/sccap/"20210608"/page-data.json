{"componentChunkName":"component---src-templates-blog-post-js","path":"/sccap/\"20210608\"/","result":{"data":{"site":{"siteMetadata":{"title":"DODO's DEV LOG","author":"dodo","siteUrl":"https://pjaeyoung.github.io","comment":{"disqusShortName":"dodo","utterances":"pjaeyoung/dodo-blog"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"4ec90316-71d2-595e-9ae2-bc9259ed1d6a","excerpt":"ì˜¤ëŠ˜ ìš°ì—°íˆ â€˜ìŠ¤í¬ë¦°ìƒ· ê°ì§€ í›„ ì•±ì‹¤í–‰â€™ ì„±ëŠ¥í–¥ìƒ ë°©ë²•ì„ ì°¾ê²Œ ë˜ì—ˆë‹¤. ğŸ˜‚  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì•„ë˜ì²˜ëŸ¼ ì§ì ‘ ìˆ˜ì •í–ˆë‹¤. ê·¸ë¦¬ê³  ìš°ë¦¬ ì•±ì—ì„œ  ì˜ callbackì¸  ì—ì„œ ê³§ë°”ë¡œ pathë¥¼ ì „ë‹¬í•˜ë©´ ëœë‹¤. íŠ¹ì´í•˜ê²Œ  ì˜ ì²« ë²ˆì§¸  ì•ˆì—ì„œ íŒŒì¼ ì‘ì—…ì„ í•˜ë©´ ë¡œë”© ì†ë„ê°€ ëŠë¦°ë° ì•„ë˜ì²˜ëŸ¼ ë‘ ë²ˆì§¸  ì—ì„œ í•˜ë©´ ë¹ ë¥´ê²Œ ë¡œë“œëœë‹¤. (ê·¸ë˜ë„ ì—¬ì „íˆ ì—¬ëŸ¬ ë²ˆ ìŠ¤í¬ë¦°ìƒ· í• ìˆ˜ë¡ í˜¸ì¶œ íšŸìˆ˜ê°€ ì¦ê°€í•œë‹¤) í•œ ê°€ì§€ ì•„ì‰¬ìš´ ì ì€ ì•„ë˜ warningâ€¦","html":"<ul>\n<li>\n<p>ì˜¤ëŠ˜ ìš°ì—°íˆ <strong>â€˜ìŠ¤í¬ë¦°ìƒ· ê°ì§€ í›„ ì•±ì‹¤í–‰â€™</strong> ì„±ëŠ¥í–¥ìƒ ë°©ë²•ì„ ì°¾ê²Œ ë˜ì—ˆë‹¤. ğŸ˜‚</p>\n<ul>\n<li><code class=\"language-text\">react-native-detector</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì•„ë˜ì²˜ëŸ¼ ì§ì ‘ ìˆ˜ì •í–ˆë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token comment\">// react-native-detector > DetectorModule.kt</span>\n<span class=\"token comment\">// ê¸°ì¡´ì— path ë„˜ê²¨ì£¼ì§€ ì•Šì€ ë¶€ë¶„ì„ ë„˜ê²¨ì£¼ë„ë¡ í•¨</span>\n<span class=\"token keyword\">override</span> <span class=\"token keyword\">fun</span> <span class=\"token function\">onScreenCaptured</span><span class=\"token punctuation\">(</span>path<span class=\"token operator\">:</span> String<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      reactContext\n              <span class=\"token punctuation\">.</span><span class=\"token function\">getJSModule</span><span class=\"token punctuation\">(</span>DeviceEventManagerModule<span class=\"token punctuation\">.</span>RCTDeviceEventEmitter<span class=\"token operator\">::</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">.</span>java<span class=\"token punctuation\">)</span>\n              ~~<span class=\"token punctuation\">.</span><span class=\"token function\">emit</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"UIApplicationUserDidTakeScreenshotNotification\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>~~\n              <span class=\"token punctuation\">.</span><span class=\"token function\">emit</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"UIApplicationUserDidTakeScreenshotNotification\"</span><span class=\"token punctuation\">,</span> path<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// react-native-detector > index.tsx</span>\n<span class=\"token comment\">// callbackì—ë„ path ë„˜ê²¨ì¤Œ</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">addScreenshotListener</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">callback<span class=\"token operator\">:</span> Function</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Platform<span class=\"token punctuation\">.</span><span class=\"token constant\">OS</span> <span class=\"token operator\">===</span> <span class=\"token string\">'android'</span><span class=\"token punctuation\">)</span> Detector<span class=\"token punctuation\">.</span><span class=\"token function\">startScreenshotDetection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> eventEmitter <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">NativeEventEmitter</span><span class=\"token punctuation\">(</span>Detector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\neventEmitter<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>\n  EventsName<span class=\"token punctuation\">.</span>UserDidTakeScreenshot<span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">~</span><span class=\"token operator\">~</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token operator\">~</span><span class=\"token operator\">~</span>\n  <span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">return</span> eventEmitter<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>ê·¸ë¦¬ê³  ìš°ë¦¬ ì•±ì—ì„œ <code class=\"language-text\">addScreenshotListener</code> ì˜ callbackì¸ <code class=\"language-text\">userDidScreenshot</code> ì—ì„œ ê³§ë°”ë¡œ pathë¥¼ ì „ë‹¬í•˜ë©´ ëœë‹¤.</li>\n<li>íŠ¹ì´í•˜ê²Œ <code class=\"language-text\">openApp</code> ì˜ ì²« ë²ˆì§¸ <code class=\"language-text\">then</code> ì•ˆì—ì„œ íŒŒì¼ ì‘ì—…ì„ í•˜ë©´ ë¡œë”© ì†ë„ê°€ ëŠë¦°ë° ì•„ë˜ì²˜ëŸ¼ ë‘ ë²ˆì§¸ <code class=\"language-text\">then</code> ì—ì„œ í•˜ë©´ ë¹ ë¥´ê²Œ ë¡œë“œëœë‹¤. (ê·¸ë˜ë„ ì—¬ì „íˆ ì—¬ëŸ¬ ë²ˆ ìŠ¤í¬ë¦°ìƒ· í• ìˆ˜ë¡ í˜¸ì¶œ íšŸìˆ˜ê°€ ì¦ê°€í•œë‹¤)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// backgroundSerivce.ts</span>\n<span class=\"token keyword\">const</span> userDidScreenshot <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>path<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token parameter\"><span class=\"token keyword\">void</span></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n<span class=\"token comment\">// base64 ë§Œ í—ˆìš©í•˜ëŠ” react-native-share ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì‘ì—…</span>\n<span class=\"token builtin\">Promise</span><span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n  <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>path<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">RNFS</span><span class=\"token punctuation\">.</span><span class=\"token function\">readFile</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">file://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>path<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">'base64'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">openApp</span><span class=\"token punctuation\">(</span>packageId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">[</span>screenshotPath<span class=\"token punctuation\">,</span> screenshotBase64<span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">navigate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Sort'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> screenshotPath<span class=\"token punctuation\">,</span> screenshotBase64 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>í•œ ê°€ì§€ ì•„ì‰¬ìš´ ì ì€ ì•„ë˜ warning ë©”ì„¸ì§€ê°€ ë‚˜ì˜¨ë‹¤. ì¶”ì¸¡ìƒ ì´ë¯¸ì§€ ê²½ë¡œëŠ” ìƒì„±ë˜ì—ˆìœ¼ë‚˜ ì´ë¯¸ì§€ íŒŒì¼ì´ ìƒì„±ëœ ê²ƒì€ ì•„ë‹ˆë¼ì„œ ê³§ì¥ í•´ë‹¹ ê²½ë¡œì— ì ‘ê·¼í•´ë„ íŒŒì¼ì´ ì—†ë‹¤ê³  ë‚˜ì˜¤ëŠ” ê²ƒ ê°™ë‹¤. (ê·¸ë˜ì„œ <code class=\"language-text\">react-native-detector</code> ê°€ screenshot pathë¥¼ ì „ë‹¬í•˜ì§€ ì•Šì€ ê¹Œë‹­ì¼ì§€ë„). í˜¹ì€ <code class=\"language-text\">openApp</code> ìì²´ê°€ ë¬¸ì œì¼ì§€ë„ ëª¨ë¥¸ë‹¤. ìì„¸í•œ ê±´ ë‚˜ì¤‘ì— ì•Œì•„ë³´ì. ì§€ê¸ˆì€ íŒŒì¼ì‹œìŠ¤í…œì— ì§‘ì¤‘!</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token punctuation\">[</span>Error<span class=\"token operator\">:</span> <span class=\"token constant\">ENOENT</span><span class=\"token operator\">:</span> <span class=\"token operator\">/</span>storage<span class=\"token operator\">/</span>emulated<span class=\"token operator\">/</span><span class=\"token number\">0</span><span class=\"token operator\">/</span><span class=\"token constant\">DCIM</span><span class=\"token operator\">/</span>Screenshots<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>pending<span class=\"token operator\">-</span><span class=\"token number\">1623761149</span><span class=\"token operator\">-</span>Screenshot_20210608<span class=\"token operator\">-</span><span class=\"token number\">214549</span>_Chrome<span class=\"token punctuation\">.</span>jpg<span class=\"token operator\">:</span> open failed<span class=\"token operator\">:</span> <span class=\"token constant\">ENOENT</span> <span class=\"token punctuation\">(</span>No such file or directory<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> open <span class=\"token string\">'/storage/emulated/0/DCIM/Screenshots/.pending-1623761149-Screenshot_20210608-214549_Chrome.jpg'</span><span class=\"token punctuation\">]</span></code></pre></div>\n</li>\n<li>\n<p>í´ë” ìƒì„± / ì‚­ì œ , ì‚¬ë³¸ì´ë¯¸ì§€ ìƒì„±/ì‚­ì œ í…ŒìŠ¤íŠ¸ ì™„ë£Œ</p>\n<ul>\n<li><code class=\"language-text\">react-native-fs</code> ì˜ <code class=\"language-text\">copyFile</code> ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì„œ ì‚¬ë³¸ ì´ë¯¸ì§€ ìƒì„±í•˜ë ¤ê³  í•  ë•Œ ê³„ì† <code class=\"language-text\">EISDIR: illegal operation on a directory</code> ì—ëŸ¬ê°€ ë‚˜ì„œ ì• ë¥¼ ë¨¹ì—ˆë‹¤. ì•Œê³ ë³´ë‹ˆ ë‚´ ì‹¤ìˆ˜.. <a href=\"https://stackoverflow.com/questions/58525721/eisdir-illegal-operation-on-a-directory-read-in-react-native-file-system\">stackoverflow</a> ì—ì„œ <code class=\"language-text\">destinationPath</code> ì˜ ë§ˆì§€ë§‰ì— íŒŒì¼ëª…ë„ ì¨ì¤˜ì•¼ í•œë‹¤ëŠ” ê±¸ ì•Œì•˜ë‹¤!</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"20210608","date":"June 08, 2021"}}},"pageContext":{"slug":"/sccap/\"20210608\"/","previous":{"fields":{"slug":"/sccap/\"20210607\"/"},"frontmatter":{"title":"20210607","category":"TIL","draft":false}},"next":{"fields":{"slug":"/sccap/\"20210609\"/"},"frontmatter":{"title":"20210609","category":"TIL","draft":false}}}},"staticQueryHashes":["3128451518","521680639"]}
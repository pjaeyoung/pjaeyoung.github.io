---
title: '20210913'
date: 2021-09-13 22:09:42
category: til
thumbnail: { thumbnailSrc }
draft: false
---

## Work

- ios에서 keychain이 제대로 동작하지 않는 문제가 해결되었다.
  - keychain 비번이 variables에 정해둔 값으로 지정이 되지 않고 login 비번도 먹히지 않아 애를 먹었다.
  - 꽤나 실랑이를 벌인 끝에 keychain을 제대로 생성했다.
  - 무조건 create 후 delete를 하는 것이 아니라 기존 keychain이 있는 지 확인 후 있으면 지우고 새로 생성하는 방식으로 keychain 꼬임 현상은 막았다.
- 그 다음 문제는 git repo 접근 문제
  - access token을 git_private_key로 넘겨주는 것은 먹히지 않는다.
  - git_private_key 설명을 보니 deploy key라고 해서 gitlab deploy key 생성 그리고 ssh 셋팅을 시도하려고 했다.
    - 그전에 팀장님께 먼저 여쭤보니 ssh는 ci server 상에서 불가능하다고 답변을 들었다. gitlab 자체적으로 방화벽이 설정되어있어서 꽤나 복잡한 절차를 거쳐야 한다고 한다.
  - basic authorization과 bearer authorization을 적용할 수 있는 지 확인하라고 했다.
    - gitlab 공식문서에서 basic은 보이지 않았고 bearer은 보였다. access token을 header에 bearer로 보내면 되는데 git_bearer_authorization에서 token만 넘겨주면 알아서 header로 넘겨준다. 그래도 실패
  - 혹시나 username을 못찾는다는 말을 보니 인증서 관리하는 계정이 gitlab에 가입되지 않은 탓이 아닐까 추측했다.
  - 팀장님은 그와중에 access token을 발행하면 같이 생성되는 bot을 활용한 접근방식으로 시도하라는 지시를 받았다.
    - 인증서 관리 계정을 고려해서 guest 권한 으로 발행하고 git_url에 bot 이름 + access token + git repo 주소를 결합한 값을 넘겼다. 실패!
    - 팀장님께서 developer 권한으로 발행해보라고 했다. 결과는 성공! 여러번 실행해도 실패/성공이 번갈아 보이는 이상한 현상은 해결했다.
  - gitlabCI와 match를 사용하는 방법에 대해 잘 안 나와있어서 고생이 많았다 ㅜㅜ (나보다는 팀장님께서...하하ㅏㅏ)

## Study

- class에서 private 기호(#)를 사용해서 속성 접근을 막는 기능이 2022년에 완전히 적용된다고 한다!! (우와)

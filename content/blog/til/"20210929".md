---
title: '20210929'
date: 2021-09-29 21:09:13
category: til
thumbnail: { thumbnailSrc }
draft: false
---

## Work

- Android 빌드 3일째 붙잡고 있다. 이러다가 영원히 못 고칠 것 같다. gradle 버전 잘못 올려서 다시 되돌리려는 데 잘 안 되서 다시 프로젝트를 펑했다.
- 새로 프로젝트를 받아 진행하면서 어떤 것들을 했는지 체크리스트를 꼼꼼히 작성했다. iOS는 이제 빌드 통과가 식은 죽 먹기. Android는 다행히도 Android Studio에서 프로젝트를 열었을 때 문제가 없다. 단지 디버깅 모드로 빌드시 문제가 있고 에러메세지가 이해가 가능한 수준으로 나왔다. 내일 아침에 곧바로 묻자!!!
- 이번 UI 컴포넌트는 되게 까다로운 요구사항이 있어서 꽤나 시간이 많이 걸렸다. 두 줄 이상 텍스트가 넘어가면 말줄임표를 표시하되 끝에 특정 단어가 꼬리말로 들어가야 했다. 한 줄일 때는 쉽게 작성했는데 두 줄이니 레이아웃이 틀어지는 현상이 나타났다. 이것도 여러 시도를 해보고 노션에 정리한 후 선배개발자분께 도움을 요청했다. 선배 개발자분은 Text 컴포넌트 속성 중 "onTextLayout" 을 사용해보라고 팁을 알려줬다. "onTextLayout"은 Text 컴포넌트의 레이아웃 정보와 text line 개수, line 별 text 값을 인자로 넘겨준다.
- 처음엔 ellipsizeMode를 middle로 해서 중앙 말줄임표 뒤에 꼬리말이 곧바로 붙도록 하려고 했다. 그런데 글자마다 크기가 다양해서 몇 글자 만큼 빈 문자열을 삽입할지 정하기 힘들었다.
- 그래서 아예 numberOfLines, ellipsizeMode 속성을 모두 제거하고 3줄 여부를 체크한 후 직접 text에 말줄임표를 만들기로 했다. 여기서도 애를 먹었다. 글자수 마다 들쑥날쑥하게 세줄이 되다 두줄이 되다 하는 현상이 있었다. 꼬리말과 합쳐진 text의 길이가 세줄인지 여부를 체크한 후 말줄임표 적용여부를 결정하는 과정을 거친다. useEffect 안에서 라인이 세줄이상이면 말줄임표를 적용하고 라인이 세줄 미만이면 말줄임표를 적용하지 않는다는 로직이 작성되어있다. 이 로직이 함께 있으면 작동이 되지 않고 useEffect와 useLayoutEffect로 나눠서 시간차를 주니 작동이 잘 된다. 그 이유가 뭔지는 잘 모르겠다. 좀 더 공부해보고 블로깅한 후 지인분들과 커뮤니티에 의견을 나눠볼 생각이다.

---
title: '20210614'
date: 2021-06-14 22:06:24
category: TIL
thumbnail: { thumbnailSrc }
draft: false
---

## 스캡 프로젝트

- 오늘 되게 진도가 안 나갔다 😂 역시나 react native는 css 처리가 정말 어렵다 ㅠㅠ
- 생성버튼 클릭할 때 **키보드 뒷편 화면은 스크롤 가능한 상태**로 바뀌는 기능과 **플로팅 버튼의 fixed(고정) 위치** 에서 애를 먹었다. 이 두가지를 동시에 작업하면서 어쩌다보니 제대로 동작한 결과물에 대해 설명하자면 아래와 같다.
- `ScrollView` 엘리먼트 안에 들어갈 item(여기선 폴더 이미지)이 적어도 스크린 화면을 넘어서야만 스크롤이 가능한 상태로 변한다. 폴더 이미지가 스크린 화면 밖으로 나갈 일이 없으니 스크롤이 불가능했다. 그래서 꼼수를 사용했다. 오직 스크롤 기능을 쓰기 위한 `View` 엘리먼트를 같이 렌더링한다. 이 엘리먼트는 스크린 화면 높이보다 크게 잡았다.

```tsx
// 스크롤
<ScrollView {...panHandlers} keyboardShouldPersistTaps="always">
  {editMode && (
    <>
      <TextInput
        autoFocus
        ref={inputRef}
        style={{
          height: 150,
          width: 150,
          borderColor: 'blue',
          borderWidth: 4,
          borderRadius: 150,
        }}
        returnKeyType="done"
        blurOnSubmit={true}
        onSubmitEditing={() => {
          setEditMode(false)
        }}
      />
      // 오로지 스크롤을 기능을 사용하기 위한 엘리먼트
      <View
        style={{ width: 1, height: Dimensions.get('screen').height * 1.5 }}
      ></View>
    </>
  )}
</ScrollView>
```

- react native에서 `fixed position` 이 없다. 처음에 `renderScrollable` 안에 넣었는데 폴더 이미지 개수에 따라 위치가 계속 어긋나는 현상이 나타났다. 그래서 `KeyboardAccessoryView` 와 형제 엘리먼트로 옮겼다. 문제는 키보드가 올라갈 때 따라 올라가는 현상이 생겼다. 그래서 **키보드가 활성화인 상태와 비활성화 상태에 따라 다르게 위치를 잡도록 css 처리**를 했다.

```tsx
const FolderScreen: React.FC = () => {
  const [editMode, setEditMode] = React.useState<boolean>(false);
  /**/

  return (
    <View
      style={{
        flex: 1,
      }}>
      // 1. 형제 엘리먼트로 옮기고
      // 2. editMode(키보드 활성화 여부/수정모드) 에 따라 위치 조정을 한다
      <FAB
        style={[
          editMode
            ? { bottom: '50%', left: '45%' }
            : {
                left: Dimensions.get('screen').width * 0.5 - 57 * 0.5,
                bottom: Dimensions.get('screen').height * 0.5 - 57,
              },
        ]}
      />
      {/**/}
      <KeyboardAccessoryView renderScrollable={renderScrollable({ editMode, setEditMode })}>
        {/**/}
      </KeyboardAccessoryView>
    </View>
```

- 아직 남아있는 문제는 키보드 활성화 혹은 수정모드 전환할 때마다 뚝뚝 끊김, 잔상이 보인다는 점이다.

- 그리고 키보드 취소/숨김 버튼을 누를 때 고정시키기 위해 `Keyboard` 의 `keyboardDidHide` 이벤트에서 다시 `input` 창을 `focus` 하도록 해서 키보드가 계속 열리도록 했다. 문제는 input창이 focus 상태이기 때문에 blur 처리 후 focus를 해야 키보드가 열린다. 그 과정에서 아래처럼 버벅거림이 발생한다. 이부분은 사용자가 완료 버튼을 주로 누를 거라는 예상하에 큰 문제는 아니라 일단은 넘어가기로 한다.

```tsx
const inputRef = React.useRef() as React.RefObject<TextInput>

const openKeyboard = () => {
  inputRef.current?.blur() // focus 상태를 한 번 풀어주고
  inputRef.current?.focus() // 다시 focus를 해야 키보드가 올라온다
}

React.useEffect(() => {
  Keyboard.addListener('keyboardDidHide', openKeyboard)
  return () => {
    Keyboard.removeListener('keyboardDidHide', openKeyboard)
  }
}, [])
```

## 얄코 유튜브 CI CD

면접 대비 겸 개발 상식을 쌓으려고 얄코 유튜브 영상을 보고 요약 정리한다.
CI는 지속적 통합이다. 개발은 주로 팀단위로 이뤄지고 git 버전 컨트롤 시스템으로 각자의 코드를 올리고 예상치 못한 결함이 없는지 테스트하고 충돌 여부를 체크한 후 정상적이면 통합하는 데 이 과정을 코드가 완성될 때마다 지속함을 의미한다. CD는 지속적 배포로,정상적으로 코드가 통합될 때마다(CI) 사용자가 사용할 수 있는 형태의 산출함을 의미한다. 대표적인 CI/CD 자동화 도구 툴로 설치형 젠킨스, 클라우드 서비스형 TravicCI, 깃헙 저장소의 GitActions 가 있다.

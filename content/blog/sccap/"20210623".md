---
title: '20210623'
date: 2021-06-23 22:06:68
category: sccap
thumbnail: { thumbnailSrc }
draft: false
---

## 스캡 프로젝트

- 폴더 클릭 시 클릭한 폴더에서 수정모드로 변경하기 완료
- 고민했던 방식 두 가지
  1. NewFolderSvg를 따로 두지 않고 FolderSvg 컴포넌트 자식으로 TextInput 컴포넌트를 두어 `editable` 속성을 `editMode` 상태 값에 따라 참/거짓으로 수정모드의 컴포넌트를 렌더링할지 결정
  2. NewFolderSvg를 그대로 사용하되 이름은 생성모드/수정모드 둘 다 쓴다는 점에서 명칭을EditableFolderSvg로 변경하고 `editableIndex` 상태값으로 렌더링할 위치를 결정
- 두 방식 모두 전제하는 조건 : 모든 FolderSvg를 렌더링하되 유저가 생성한 폴더 개수를 초과한 FolderSvg는 `display`를 `none` 해둠
- 1번은 뒤로가기에도 키보드를 고정시키려 만들어 뒀던 `useKeyboard` 가 이상현상(키보드가 계속 보였다가 사라지는 것을 반복하는 현상)을 일으켜서 2번 방식으로 진행함. 상위 컴포넌트인 FolderScreen 에서 내려주는 `borderColor`, `folderName` 상태 값이 변경될 때마다 FolderSvg 컴포넌트들이 계속 렌더링하게 되기 때문에 나타나는 현상. 그래서 `borderColor` , `folderName` 변경사항에 영향을 받는 컴포넌트를 최소화하기 위해 2번 방식 택함. 2번 방식은 EditableFolderSvg(구명칭 : NewFolderSvg) 하나만 영향을 받음.
- EditableFolderSvg는 이제 생성모드와 수정모드 둘 다 사용하기 때문에 내부에서 folderLayout을 처리하는 대신 외부에서 값을 받도록 함
- 폴더 이미지 클릭 이벤트를 등록할 때 예상치 못한 이슈를 발견함.
  - FolderSvg 를 TouchableOpacity 컴포넌트로 감싸서 구현하려고 시도했음
  - 문제는 FolderSvg 컴포넌트 자식인 DeleteButton의 클릭 이벤트가 먹히지 않음. TouchableOpacity의 클릭 이벤트로 흡수됨
  - 그래서 FolderSvg와 DeleteButton을 분리함
  - DeleteButton이 이제 부모 컴포넌트가 스크린화면 전체로 잡혔으므로 layout을 다시 재정의함

```tsx
<>
  {userFolders.map(({ id, folderName, borderColor }, index) => {
    const FolderSvg = FolderSvgs[index]
    return (
      <React.Fragment key={id}>
        <TouchableOpacity
          style={[userFolderLayoutData[index].folderLayout]}
          onPress={onEditMode(index)}
        >
          <FolderSvg borderColor={borderColor}>
            <FolderName top={index === 1 ? '60%' : '45%'}>
              {folderName}
            </FolderName>
          </FolderSvg>
        </TouchableOpacity>
        {!editMode && (
          <DeleteButton
            style={userFolderLayoutData[index].deleteButtonLayout}
            onPressIn={onClickDeleteButton(id)}
          >
            <Icon name="remove" color="#fff" />
          </DeleteButton>
        )}
      </React.Fragment>
    )
  })}
</>
```

- 수정모드에서 이름 변경없이 완료 버튼할 때 폴더명 중복 Toast가 뜨는 이슈가 생김

  - 폴더명 중복 체크할 때 id가 동일하지 않는 조건을 추가하여 해결

  ```tsx
  if (
    userFolders.find(
      userFolder => userFolder.id !== id && userFolder.folderName === folderName
    )
  ) {
    ToastAndroid.show('중복된 폴더명 입력', ToastAndroid.SHORT)
    return
  }
  ```

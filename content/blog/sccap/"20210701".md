---
title: '20210701'
date: 2021-07-01 21:07:39
category: sccap
thumbnail: { thumbnailSrc }
draft: false
---

## 스캡프로젝트

- MAIN화면에서 기본폴더 클릭 시 CATEGORY 화면으로 넘어가는 부분에서 **이슈**가 생김
- 예외케이스인 기본폴더 생각 안 하고 코드를 짰더니 발생한 이슈 😂
- 기존의 파일 시스템을 다루는 파일 fsFunctions는 SCCAP 폴더를 기준으로 CRUD로 구현된 상태고그와 달리 기본폴더는 스크린샷폴더에 속함.
- 그래서, 아래와 같은 수정사항이 발생함

  - 스토리지에 담길 폴더 데이터 형식 변경

    ```tsx
    interface IStoredFolder {
      id: string
      folderName: string
      borderColor: string
      filePath: string // 파일 경로
    }
    ```

  - fsFunctions 인자 변경

    ```tsx
    // 기존 folderName 대신 filePath 전달
    export const readFolderAsync = ({
      filePath,
      onSuccess,
      onFailure,
    }: {
      folderName: string
      onSuccess?: Function
      onFailure?: Function
    }) => {
      handleAsync<RNFS.ReadDirItem[]>({
        onSuccess,
        onFailure,
        asyncFunction: () => RNFS.readDir(filePath),
      })
    }
    ```

- 대대적인 수정사항이 발생해서 일단 미루기로 함, 가장 중요한 openApp 부터 해결하는 게 우선임
- 기본폴더에 대한 예외케이스의 경우 어떻게 다뤄야할 지 잠깐 정리하자면 아래와 같음
  - 파일 접근권한이 허용되었을 때 순차적으로 진행
  1. 폰 기종마다 다른 스크린샷폴더 경로 문제 대응을 위해, 스크린샷을 사용자 몰래 실행시켜 filePath를 알아낸다.
  2. 알아낸 filePath와 id는 basicFolder인 IStoredFolder 데이터를 생성한다.
  3. 2에서 생성한 기본폴더데이터를 storage에 저장한다.
- storage에 들어있는 userFolders 와 redux 연동 완료
  - 이 기능을 구현하니 떡하니 **크리티컬한 문제**가 보인다.
  - 생성한 폴더들이 제대로 저장이 되고 있지 않는다.
  - 이 부분은 redux loading 처리를 하지 않았기 때문에 발생한 문제
  - 곧바로 수정이 들어가야함

---
title: '18'
date: 2021-03-04 10:03:50
category: challenge30
thumbnail: { thumbnailSrc }
draft: false
---

## [ TIL ] lazy loading
javascript로 lazy loading을 구현하는 방법을 알게 되었다. 
lazy loading은 모든 이미지를 화면에서 로드하는 대신 화면에서 보여질 부분만 로드하는 기법이다. 
코드 상으로 설명하자면 img 태그의 속성인 src에 곧바로 이미지 파일 경로를 입력하는 대신 디폴트 이미지를 입력하고 실제 이미지 파일 경로는 dataset에 저장한다. 팝업 혹은 스크롤로 인해 화면에 보이는 순간 디폴트 이미지를 dataset에 저장한 실제 이미지 파일로 대체한다. 

lazy loading을 구현하려면 `IntersectionObserver` 클래스를 사용한다. 
`IntersectionObserver`는 특정 엘리먼트가 화면에 보여졌는지 감지하는 기능을 수행한다.
처음 new 연산자로 인스턴스를 생성할 때 생성자 인자로 '화면에 나타났을 때 실행할 동작을 정의한' callback 함수와 '보여질 화면(엘리먼트) 설정과 얼마만큼 보여지면 콜백을 실행할지 결정할 비율(0.0~1.0)'에 대한 옵션을 넘겨준다. callback은 반드시 넘겨줘야 할 필수 인자고 옵션은 말그대로 넘겨주지 않아도 디폴트 값으로 셋팅된다. 

lazy loading 구현 시 아래 사항을 고려한다. 
    - 어떤 화면(브라우저 스크린 혹은 화면에서 일부 구간)에서 보여줄지 결정한다. option의 root에 해당 정보를 입력한다.
    - 어느 정도로 엘리먼트가 화면에서 노출되면 콜백함수를 실행할지 결정한다. option의 thresold에 해당 정보를 입력한다. 
    - 화면에 노출될 때 어떤 동작을 실행할지 결정한다. 여기서는 img의 src 값을 img의 dataset에 저장한 실제 경로값으로 대체하는 로직이 작성되어야 한다. 그리고 더이상 '감지'할 필요가 없으므로 감지해제 하는 과정도 여기서 이뤄진다. callback 함수에 해당 정보를 입력한다.
    - 화면 노출 여부를 확인해야 할 대상(태그)들을 가져와 `IntersectionObeserver` 인스턴스에 감지 대상 목록에 등록한다.   

lazy loading 구현과정에서 디폴트 이미지 파일이 없어 src를 비워둔 채로 로드했더니 '이미지가 깨졌을 때' 나오는 아이콘이 생겨서 거슬렸다. 코드로 아이콘을 지우는 방법을 찾다가 `data-url` 방식으로 투명 이미지를 생성하는 방법을 알게 되었다. 


### 참고 자료
[lazy-loading](http://yoonbumtae.com/?p=2847&unapproved=573&moderation-hash=58b869fac7c795a542c36fe5da4d2abb#comment-573) </br>
[투명이미지](https://blog.serpongs.net/59) </br>
[data-url vs image file](https://mygumi.tistory.com/282)

## [ Daily ] 
오늘 NomadCoders에서 주최한 투두리스트 대회 수상자 발표가 나왔다. 비록 제출은 못 했지만 나름 독특하게 했다고 생각했는데 수상작들을 보니 그 생각이 쏙 들어갔다. 짧은 시간 안에 여러 가지 기능들을 적용하고 css로 화려하게 꾸민 작품들을 보니 좌절감이 들 법한데 오기가 생긴다. 나도 저만큼 하고 말거다! 하는 마음 말이다. 책을 읽고 책 따라 코드 작성만 하고 있었는데 작은 프로젝트도 겸해서 해야겠다.

요즘 늦잠을 많이 잔다. 앞으로 마치 직장을 다니는 것처럼 9시 - 6시로 공부 시간을 가진다. 
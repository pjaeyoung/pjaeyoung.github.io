---
title: '25'
date: 2021-04-25 19:04:40
category: challenge30
thumbnail: { thumbnailSrc }
draft: false
---

## react native 스크립트 명령어 parallex로 사용하기

![스크린샷, 2021-04-26 22-15-38](https://user-images.githubusercontent.com/47022167/116088590-f9450c80-a6dc-11eb-8f3b-d3d81dccafee.png)

최근 안드로이드 앱을 만드는 프로젝트를 진행하고 있다.
터미널 하나에 명령어 한줄만 치면 웹어플리케이션이 실행했던 것과 달리 metro 서버를 키고 android build 후 devtools를 실행하는(총 3번에 걸처 진행해야 하는) 번거로움이 있다.

![스크린샷, 2021-04-26 22-14-45](https://user-images.githubusercontent.com/47022167/116088585-f8ac7600-a6dc-11eb-8029-d1c894240ab5.png)

커맨드 명령어를 연달아 실행하는 기호가 `&&` 와 `&`가 존재한다. `&&`는 앞의 커맨드 실행이 완료된 후 뒤의 커맨드가 실행되는 구조다. `&`는 앞의 커맨드가 실행과 동시에 병렬적으로 뒤의 커맨드도 실행된다.

문제는 `&`로 `yarn start & yarn android & yarn devtools`를 실행하면 android emulator가 제대로 작동이 되지 않았다.(이때는 metro가 선행되어야 android emulator가 실행이 된다고 생각했다.)

구글링하다 [concurrently](https://www.npmjs.com/package/concurrently) 패키지를 발견했다. concurrently는 계속 실행되어야 하는 다중 커맨드를 동시에 실행할 수 있게 도와준다.

concurrently를 설치하고

```bash
yarn add -D concurrently
```

package.json 파일에서 script를 아래와 같이 지정하면 된다.

```json
{
  "scripts": {
    "android": "react-native run-android",
    "start": "react-native start",
    "dev": "concurrently --kill-others \"yarn start\" & yarn android & yarn devtools",
    "devtools": "react-devtools"
  }
}
```

** 추가 사항 **

concurrently 패키지를 설치하지 않고 하는 방법을 알았다. 커맨드 실행 순서만 바꿔주면 된다.

```json
{
  "scripts": {
    "android": "react-native run-android",
    "start": "react-native start",
    "dev": "yarn android & yarn devtools & yarn start",
    "devtools": "react-devtools"
  }
}
```

## husky 대신 node-git-hooks 도입기

최근에 husky가 상업용 프로젝트 사용에 제약을 걸어서 대안 라이브러리를 찾다 `node-git-hooks`를 알게 되었다([관련 아티클](https://taegon.kim/archives/10276)).

사용방법은 다음과 같다.

1. `node-git-hooks`와 `lint-staged`를 설치한다.

```bash
yarn add -D node-git-hooks lint-staged

```

2. package.json에서 스크립트를 작성한다.

```json
{
  "scripts": {
    "postinstall": "node-git-hooks", // 반드시 작성할 것
    "test": "jest --passWithNoTests",
    "lint": "eslint --no-error-on-unmatched-pattern --ext .tsx --ext .ts .",
    "lint-staged": "lint-staged"
  },
  "lint-staged": {
    "**/*.{ts,tsx}": ["yarn lint", "yarn test"]
  }
}
```

3. 커스텀 githooks를 팀원들과 같이 사용하기 위해 `.githooks` 폴더(이름은 아무거나 상관없음)를 프로젝트 최상단에 생성한다. 그 다음 사용할 hooks 파일을 작성한다(나는 pre-commit과 pre-push만 작성했다).

![스크린샷, 2021-04-26 22-45-33](https://user-images.githubusercontent.com/47022167/116092908-2c899a80-a6e1-11eb-8ba6-9f9f86aae2c7.png)

4. hooks 파일은 해당 hook에서 실행하길 원하는 script 명령어를 작성한다.

커밋할 때는 staged에 올려진 파일들만 검사하고

```txt
# .githooks/pre-commit

yarn lint-staged

```

푸쉬할 때는 전체 파일을 검사하도록 지정했다.

```txt
# .githooks/pre-push

yarn lint && yarn test

```

5. 만들어 놓은 hooks 파일들을 실행시키기 위해서는 실행권한을 지정해줘야 한다.

```bash
# .githooks 안의 모든 폴더에 실행권한(x) 부여
chmod +x .githooks/*

```

6. 마지막으로 기존에 설정된 git hook 실행 경로를 새로 만든 `.githooks` 가 있는 경로로 변경해야 한다.

```bash
git config core.hookspath .githooks

```
